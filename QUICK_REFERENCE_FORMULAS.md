# Quick Reference: Balance Sheet Formulas

## ğŸ“Š P&L â†’ Balance Sheet Mappings (At a Glance)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         P&L STATEMENT                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Revenue                  â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  COGS                     â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”                               â”‚
â”‚  Operating Expenses       â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”                           â”‚
â”‚  Depreciation            â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”                       â”‚
â”‚  Net Income              â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚   â”‚   â”‚   â”‚   â”‚
                                  â–¼   â–¼   â–¼   â–¼   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BALANCE SHEET                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSETS               â”‚ LIABILITIES & EQUITY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Current Assets:      â”‚ Current Liabilities:                         â”‚
â”‚                      â”‚                                              â”‚
â”‚  Cash .............. â”‚  Accounts Payable â—„â”€â”€â”€ OpEx (DPO)          â”‚
â”‚    (balancing plug)  â”‚  Accrued Expenses â—„â”€â”€â”€ Expenses (%)         â”‚
â”‚                      â”‚  Deferred Revenue â—„â”€â”€â”€ Revenue (%)          â”‚
â”‚  AR â—„â”€â”€â”€ Revenue     â”‚                                              â”‚
â”‚       (DSO formula)  â”‚ Long-term Liabilities:                       â”‚
â”‚                      â”‚  [Growth-based]                              â”‚
â”‚  Inventory â—„â”€â”€â”€ COGS â”‚                                              â”‚
â”‚       (DIO formula)  â”‚ Equity:                                      â”‚
â”‚                      â”‚                                              â”‚
â”‚  Prepaid â—„â”€â”€â”€ Rev(%) â”‚  Common Stock (static)                      â”‚
â”‚                      â”‚  Retained Earnings â—„â”€â”€â”€ Net Income          â”‚
â”‚ Fixed Assets:        â”‚       (rollforward with dividends)           â”‚
â”‚                      â”‚                                              â”‚
â”‚  PPE â—„â”€â”€â”€ Rev + Depr â”‚                                              â”‚
â”‚      (CapEx - Depr)  â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’° The 11 Core Formulas

### **Working Capital (Driver-Based)**

```
1. Accounts Receivable
   AR = (Revenue_monthly Ã— 12) / 365 Ã— DSO
   Default DSO: 30 days

2. Inventory  
   Inv = (COGS_monthly Ã— 12) / 365 Ã— DIO
   Default DIO: 45 days

3. Accounts Payable
   AP = (OpEx_monthly Ã— 12) / 365 Ã— DPO
   Default DPO: 30 days

4. Accrued Expenses
   Accrued = Total_Expenses Ã— 5%
   Default: 5%

5. Prepaid Expenses
   Prepaid = Revenue Ã— 1%
   Default: 1%
```

### **Long-term Assets (Driver-Based)**

```
6. Property, Plant & Equipment
   PPE(t) = PPE(t-1) + CapEx - Depreciation
   
   Where:
   CapEx = (Revenue_monthly Ã— 12) Ã— 3% / 12
   Depreciation = P&L value OR PPE(t-1) Ã— 10% / 12
   
   Defaults: CapEx 3% of revenue, Depreciation 10% annual
```

### **Liabilities (Driver-Based)**

```
7. Deferred Revenue
   Deferred = Revenue Ã— 8%
   Default: 8% (SaaS model)
```

### **Equity (Driver-Based)**

```
8. Retained Earnings
   RE(t) = RE(t-1) + Net_Income - Dividends
   
   Where:
   Dividends = Net_Income Ã— Dividend_Policy%
   Default: 0%
```

### **Static Items**

```
9. Common Stock
   Common_Stock(t) = Common_Stock(t-1)
   (No change unless manually adjusted)
```

### **Growth-Based (Fallback)**

```
10. Other Assets/Liabilities
    Value(t) = Value(t-1) Ã— (1 + 5%/12)
    Default: 5% annual growth
```

### **Balancing**

```
11. Cash (THE MAGIC FORMULA)
    Cash = Total_Liabilities + Total_Equity - Sum(All_Other_Assets)
    
    This ensures: Assets = Liabilities + Equity
```

---

## ğŸ’¸ Cash Flow Statement (3-Step Process)

### **Operating Activities**
```
Net Income                              (from P&L)
+ Depreciation                          (add back non-cash)
- Increase in AR                        (â†‘AR = cash out)
- Increase in Inventory                 (â†‘Inv = cash out)
+ Increase in AP                        (â†‘AP = cash in)
+ Increase in Accrued Expenses          (â†‘Accrued = cash in)
- Increase in Prepaid Expenses          (â†‘Prepaid = cash out)
= Operating Cash Flow
```

### **Investing Activities**
```
- Capital Expenditures                  CapEx = Î”PPE + Depreciation
- Acquisitions                          (future)
+ Asset Sales                           (future)
= Investing Cash Flow
```

### **Financing Activities**
```
- Dividends Paid                        Net_Income Ã— Dividend%
+ Debt Issuance (or - Repayment)       Î”Debt
+ Stock Issuance (or - Repurchase)     Î”Common_Stock
= Financing Cash Flow
```

### **Reconciliation**
```
Beginning Cash
+ Operating CF
+ Investing CF
+ Financing CF
= Ending Cash (should match Balance Sheet Cash)
```

---

## ğŸ›ï¸ Default Settings (All User-Configurable)

```javascript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Working Capital Assumptions                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DSO (Days Sales Outstanding)          30 days  â”‚
â”‚ DPO (Days Payable Outstanding)         30 days  â”‚
â”‚ DIO (Days Inventory Outstanding)       45 days  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Fixed Asset Assumptions                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Annual Depreciation Rate               10%      â”‚
â”‚ CapEx as % of Annual Revenue           3%       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Policy Assumptions                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dividend Policy (% of Net Income)      0%       â”‚
â”‚ Minimum Cash Buffer                    30 days  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Accrual Assumptions                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Accrued Expenses (% of Expenses)       5%       â”‚
â”‚ Prepaid Expenses (% of Revenue)        1%       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Growth Assumptions (Fallback)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Working Capital Growth Rate            5%/year  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” P&L Line Item Detection Patterns

The system automatically searches for these variations:

```
Revenue:
  âœ“ total revenue, net revenue, total sales, net sales
  âœ“ gross revenue, revenue total, sales total
  âœ“ total income, gross sales

COGS:
  âœ“ cost of goods sold, total cogs, cogs
  âœ“ cost of sales, total cost of sales

Operating Expenses:
  âœ“ operating expenses, total opex, opex
  âœ“ total expenses, operational expenses
  âœ“ selling general administrative, sg&a

Net Income:
  âœ“ net income, net profit, net earnings
  âœ“ profit after tax, bottom line, earnings

Depreciation:
  âœ“ depreciation, depreciation expense
  âœ“ amortization, depreciation and amortization, d&a
```

---

## âš¡ Quick Examples

### Example 1: Calculate AR
```
Given:
- Monthly Revenue = $120,000
- DSO = 30 days

Calculation:
AR = ($120,000 Ã— 12) / 365 Ã— 30
AR = $1,440,000 / 365 Ã— 30
AR = $118,356
```

### Example 2: Calculate Inventory
```
Given:
- Monthly COGS = $60,000
- DIO = 45 days

Calculation:
Inventory = ($60,000 Ã— 12) / 365 Ã— 45
Inventory = $720,000 / 365 Ã— 45
Inventory = $88,767
```

### Example 3: Calculate PPE
```
Given:
- Previous PPE = $1,000,000
- Monthly Revenue = $120,000
- CapEx % = 3%
- Depreciation Rate = 10%

Calculation:
Annual Revenue = $120,000 Ã— 12 = $1,440,000
Annual CapEx = $1,440,000 Ã— 3% = $43,200
Monthly CapEx = $43,200 / 12 = $3,600

Monthly Depreciation = $1,000,000 Ã— 10% / 12 = $8,333

New PPE = $1,000,000 + $3,600 - $8,333 = $995,267
```

### Example 4: Calculate Retained Earnings
```
Given:
- Previous RE = $500,000
- Net Income = $50,000
- Dividend Policy = 10%

Calculation:
Dividends = $50,000 Ã— 10% = $5,000
New RE = $500,000 + $50,000 - $5,000 = $545,000
```

### Example 5: Calculate Operating Cash Flow
```
Given:
- Net Income = $50,000
- Depreciation = $8,333
- AR increased by $5,000
- Inventory increased by $2,000
- AP increased by $1,500

Calculation:
Operating CF = $50,000 + $8,333 - $5,000 - $2,000 + $1,500
Operating CF = $52,833
```

---

## ğŸš¨ Common Mistakes to Avoid

âŒ **DON'T** use annual revenue directly in DSO formula  
âœ… **DO** annualize monthly revenue first: `(Revenue_monthly Ã— 12) / 365 Ã— DSO`

âŒ **DON'T** forget to divide by 12 for monthly CapEx  
âœ… **DO** calculate annual CapEx first, then divide: `(Annual_Revenue Ã— CapEx%) / 12`

âŒ **DON'T** calculate cash before other items  
âœ… **DO** calculate cash last as the balancing plug

âŒ **DON'T** forget to add back depreciation in cash flow  
âœ… **DO** add depreciation to net income (it's non-cash)

âŒ **DON'T** ignore the sign on working capital changes  
âœ… **DO** remember: â†‘Assets = cash OUT, â†‘Liabilities = cash IN

---

## ğŸ“ Where to Find in Code

| Component | File | Lines |
|-----------|------|-------|
| Balance Sheet Engine | `src/app.js` | 4749-5200 |
| Cash Flow Engine | `src/app.js` | 5215-5650 |
| P&L Mapping Patterns | `src/app.js` | 2255-2293 |
| Balance Sheet Assumptions | `src/app.js` | 3582-3617 |
| Default Settings | `src/app.js` | 3598-3617 |

---

**Pro Tip**: All formulas are in `BalanceSheetCalculationEngine` class and `CashFlowCalculationEngine` class!

---

**Last Updated**: 2025-10-06  
**For detailed explanations**: See `BALANCE_SHEET_FORMULAS_AND_MAPPINGS.md`
